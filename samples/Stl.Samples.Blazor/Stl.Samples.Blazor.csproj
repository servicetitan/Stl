<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>netstandard2.1</TargetFramework>
    <RazorLangVersion>3.0</RazorLangVersion>
    <BlazorWebAssemblyEnableLinking>false</BlazorWebAssemblyEnableLinking>
  </PropertyGroup>
  
  <ItemGroup>
    <PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly" />
    <PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly.Build" PrivateAssets="all" />
    <PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly.DevServer" PrivateAssets="all" />
    <PackageReference Include="Microsoft.Extensions.Logging.Debug" />
    <PackageReference Include="System.Net.Http.Json" />
  </ItemGroup>
  
  <ItemGroup>
    <None Include="$(ProjectDir)\wwwroot\**" CopyToOutputDirectory="PreserveNewest" LinkBase="wwwroot\" />
  </ItemGroup>
  
  <ItemGroup>
    <ProjectReference Include="..\..\src\Stl.Fusion.Client\Stl.Fusion.Client.csproj" />
    <ProjectReference Include="..\..\src\Stl.Fusion\Stl.Fusion.csproj" />
    <ProjectReference Include="..\..\src\Stl\Stl.csproj" />
    <ProjectReference Include="..\Stl.Samples.Blazor.Common\Stl.Samples.Blazor.Common.csproj" />
  </ItemGroup>

  <Target Name="CreateCmdFiles" AfterTargets="CopyFilesToOutputDirectory">
    <PropertyGroup>
      <DevServerCmdPath>$(TargetDir)DevServer.cmd</DevServerCmdPath>
      <ChromeDebugCmdPath>$(TargetDir)ChromeDebug.cmd</ChromeDebugCmdPath>
      <DebugMeCmdPath>$(TargetDir)DebugMe.cmd</DebugMeCmdPath>
      <DevServerCmdContent>
        @dotnet "$(_BlazorDevServerDll)" serve --applicationpath "$(TargetPath)"
      </DevServerCmdContent>
      <ChromeDebugCmdContent>
        @start "Chrome" chrome.exe --remote-debugging-port=9222 --user-data-dir="$(Temp)\blazor-chrome-debug" http://localhost:5000/
      </ChromeDebugCmdContent>
      <DebugMeCmdContent>
@echo off 
start "Blazor DevServer" cmd /C "$(DevServerCmdPath)"
call "$(ChromeDebugCmdPath)"
      </DebugMeCmdContent>
    </PropertyGroup>
    <WriteLinesToFile File="$(DevServerCmdPath)" Lines="$(DevServerCmdContent)" Overwrite="true" />
    <WriteLinesToFile File="$(ChromeDebugCmdPath)" Lines="$(ChromeDebugCmdContent)" Overwrite="true" />
    <WriteLinesToFile File="$(DebugMeCmdPath)" Lines="$(DebugMeCmdContent)" Overwrite="true" />
  </Target>
  
</Project>
